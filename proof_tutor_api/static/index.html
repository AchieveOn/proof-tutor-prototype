<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proof Tutor - AI出題版</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>証明ヒントAI (Proof Tutor)</h1>
        
        <!-- ステップ1: 出題フェーズ -->
        <div id="phase-generate" class="phase active">
            <div class="guide">
                <h2>ステップ1: 証明問題を出題してもらう</h2>
                <p>「出題」ボタンをクリックすると、AIが証明問題を自動生成します。難易度を選択してください。</p>
            </div>

            <div class="difficulty-selector">
                <label for="difficulty">難易度を選択:</label>
                <select id="difficulty">
                    <option value="easy">簡単（中学1年生レベル）</option>
                    <option value="medium" selected>標準（中学2-3年生レベル）</option>
                    <option value="hard">難しい（高校1年生レベル）</option>
                </select>
            </div>

            <button id="generate-button" class="btn-primary">出題する</button>
            <p id="generate-loading" class="hidden">AIが問題を生成中...</p>
            <div id="generate-error" class="hidden error"></div>
        </div>

        <!-- ステップ2: 問題表示フェーズ -->
        <div id="phase-problem" class="phase hidden">
            <div class="guide">
                <h2>ステップ2: 問題に解答する</h2>
                <p>AIが生成した証明問題が表示されています。「生徒の途中記述」に、あなたが現在までに書いた証明を入力してください。</p>
            </div>

            <div class="problem-display">
                <div class="problem-card">
                    <h3>【定理・文脈】</h3>
                    <p id="problem-theorem"></p>
                </div>
                <div class="problem-card">
                    <h3>【与条件】</h3>
                    <p id="problem-given"></p>
                </div>
                <div class="problem-card">
                    <h3>【結論】</h3>
                    <p id="problem-to-prove"></p>
                </div>
            </div>

            <form id="hint-form">
                <div class="input-group">
                    <label for="student_attempt"><strong>【生徒の途中記述】</strong> <span>(現在までに書いた証明をすべて入力)</span></label>
                    <textarea id="student_attempt" rows="8" placeholder="例：&#10;1. 仮定より、AB = DE&#10;2. 仮定より、BC = EF&#10;3. ここから先をどう進めるか考えてください..." required></textarea>
                </div>

                <button type="submit" id="submit-button" class="btn-primary">次の一歩のヒントを見る</button>
                <p id="hint-loading" class="hidden">AIが考えています...</p>
            </form>

            <button id="back-button" class="btn-secondary">別の問題を出題する</button>
        </div>

        <!-- ステップ3: ヒント表示フェーズ -->
        <div id="hint-output" class="hidden">
            <h2>AIからのヒント</h2>
            <div class="card">
                <h3>次の一歩 (Next Hint)</h3>
                <p id="next-hint-text"></p>
            </div>
            <div class="card why-card">
                <h3>なぜその一歩か (Why)</h3>
                <p id="why-text"></p>
            </div>
            <div class="diagnosis-log">
                <h3>診断ログ (Diagnosis for Teacher)</h3>
                <p id="diagnosis-text"></p>
            </div>
            <button id="continue-button" class="btn-secondary">別の途中記述を試す</button>
        </div>

        <div id="error-message" class="hidden error">
            <p>エラーが発生しました。</p>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>

